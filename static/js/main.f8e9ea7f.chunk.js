(this.webpackJsonpcahoots=this.webpackJsonpcahoots||[]).push([[0],{39:function(e,t,a){e.exports={centered:"styles_centered__x3bzC"}},41:function(e,t,a){e.exports={hero_heading:"styles_hero_heading__1odbt"}},44:function(e,t,a){e.exports=a(83)},49:function(e,t,a){},51:function(e,t,a){},83:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),l=a.n(c),o=(a(49),a(8)),i=a(9),u=(a(50),a(51),a(5)),s=a(85),m=a(86),d=a(87),h=a(88),f=a(89),g=a(14),v=a(15),E=a(21),b=a(20),p=a(52),j=JSON.parse('{"apiKey": "AIzaSyCVQuIPNV6lxmIXs2XHWUTzPkleI2Qo_o8","authDomain": "vialquiz-ea6a8.firebaseapp.com","databaseURL": "vialquiz-ea6a8.southamerica-east1.firebasedatabase.app","projectId": "vialquiz-ea6a8","storageBucket": "vialquiz-ea6a8.appspot.com","messagingSenderId": "927740651049","appId": "1:927740651049:web:3c8f3912f9c20d859e5e38","measurementId": "G-5G5HCQLWSF"}'),O=Object(v.a)((function e(t){Object(g.a)(this,e),p.apps.length||p.initializeApp(j),this.firestore=p.firestore(),this.auth=p.auth()})),w=function(e){Object(E.a)(a,e);var t=Object(b.a)(a);function a(){return Object(g.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.firestore.collection("games").doc(t.gameId).collection("players").doc(e).get().then(this._convertDocToPlayer)}},{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.firestore;if("gameId"in e){var a=e.gameId;delete e.gameId,t=t.collection("games").doc(a).collection("players")}return t.add(e).then((function(e){return e.get()})).then(this._convertDocToPlayer)}},{key:"list",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,n=this.firestore;return"gameId"in t&&(n=n.collection("games").doc(t.gameId)),n=n.collection("players"),"limit"in t&&(n=n.limit(t.limit)),void 0!==a?n.onSnapshot((function(t){var n=[];t.forEach((function(t){return n.push(e._convertDocToPlayer(t))})),a(n)})):n.get().then((function(t){return t.docs.map((function(t){return e._convertDocToQuestion(t)}))}))}},{key:"_convertDocToPlayer",value:function(e){return Object.assign({id:e.id},e.data())}}]),a}(O),y=function(e){return(new w).create(e)},C=a(84),I=a(39),k=a.n(I),S=function(e){return r.a.createElement(C.a,{className:k.a.centered,style:{maxWidth:e.maxWidth||null,height:e.verticalCentered?"100%":null}},e.children)},N=function(){function e(){Object(g.a)(this,e)}return Object(v.a)(e,null,[{key:"STATE_DRAFT",get:function(){return"draft"}},{key:"STATE_WAITING_FOR_PLAYERS",get:function(){return"waitingForPlayers"}}]),e}(),_=function(e){Object(E.a)(a,e);var t=Object(b.a)(a);function a(){return Object(g.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.firestore.collection("games").add(Object.assign({state:N.STATE_DRAFT},e)).then((function(e){return e.get()})).then(this._convertDocToGame)}},{key:"get",value:function(e,t){var a=this,n=this._getGameDoc(e);return void 0!==t?n.onSnapshot((function(e){return t(a._convertDocToGame(e))})):n.get().then(this._convertDocToGame)}},{key:"list",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=this.firestore.collection("games");return"ownerId"in t&&(a=a.where("ownerId","==",t.ownerId)),"state"in t&&(a=a.where("state","==",t.state)),"shortCode"in t&&(a=a.where("shortCode","==",t.shortCode)),"limit"in t&&(a=a.limit(t.limit)),a.get().then((function(t){return t.docs.map((function(t){return e._convertDocToGame(t)}))}))}},{key:"update",value:function(e,t){var a=this._getGameDoc(e);return"currentQuestionId"in t&&(t.currentQuestion=a.collection("questions").doc(t.currentQuestionId),delete t.currentQuestionId),a.update(t)}},{key:"_getGameDoc",value:function(e){return this.firestore.collection("games").doc(e)}},{key:"_convertDocToGame",value:function(e){var t=Object.assign({id:e.id},e.data());return"currentQuestion"in t&&(t.currentQuestionId=t.currentQuestion.id,t.currentQuestion=t.currentQuestion.path),t}}]),a}(O),A=function(e,t){return(new _).get(e,t)},D=function(e){var t=e.playerName,a=e.setPlayerName,n=e.joinGame;return r.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),n()}},r.a.createElement(m.a,null,r.a.createElement(d.a,null,"Your Nickname:"),r.a.createElement(h.a,{value:t,onChange:function(e){return a(e.target.value)}})),r.a.createElement(f.a,{color:"primary",type:"submit"},"JOIN"))},x=function(){var e=Object(i.h)().gameId,t=Object(n.useState)(""),a=Object(u.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(""),s=Object(u.a)(o,2),m=s[0],d=s[1],h=Object(n.useState)(null),f=Object(u.a)(h,2),g=f[0],v=f[1];return Object(n.useEffect)((function(){e&&null===g&&A(e).then(v)}),[e,g]),r.a.createElement(S,{maxWidth:500,verticalCentered:!0},r.a.createElement("h1",null,g?g.name:null),m?r.a.createElement(i.a,{to:"/play/".concat(e,"/as/").concat(m)}):r.a.createElement(D,{playerName:c,setPlayerName:l,joinGame:function(){return y({name:c,gameId:e}).then((function(e){return d(e.id)}))}}))},T=a(90),q=a(91),Q=a(102),W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new w).get(e,t)},U=function(e){Object(E.a)(a,e);var t=Object(b.a)(a);function a(){return Object(g.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"create",value:function(e){var t=this._popAttr(e,"gameId"),a=this._popAttr(e,"playerId"),n=this._popAttr(e,"questionId");return this.firestore.collection("games").doc(t).collection("answers").add(Object.assign({player:this.firestore.doc(["/games",t,"players",a].join("/")),question:this.firestore.doc(["/games",t,"questions",n].join("/"))},e)).then((function(e){return e.get()})).then(this._convertDocToAnswer)}},{key:"list",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=this.firestore;return"gameId"in t&&(a=a.collection("games").doc(t.gameId)),a=a.collection("answers"),"questionId"in t&&(a=a.where("question","==",this.firestore.doc("games/".concat(t.gameId,"/questions/").concat(t.questionId)))),"limit"in t&&(a=a.limit(t.limit)),a.get().then((function(t){return t.docs.map((function(t){return e._convertDocToAnswer(t)}))}))}},{key:"_convertDocToAnswer",value:function(e){return Object.assign({id:e.id},e.data())}},{key:"_popAttr",value:function(e,t){var a=e[t];return delete e[t],a}}]),a}(O);function P(e,t){var a=e[t];return delete e[t],a}var G=function(e){Object(E.a)(a,e);var t=Object(b.a)(a);function a(){return Object(g.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"get",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.firestore,r={};return"gameId"in a&&(n=n.collection("games").doc(a.gameId).collection("questions"),r.gameId=a.gameId),n.doc(e).get().then((function(e){return t._convertDocToQuestion(e,r)}))}},{key:"create",value:function(e){var t=this,a=Object.assign({},e),n=P(a,"gameId");return this.firestore.collection("games").doc(n).collection("questions").add(a).then((function(e){return e.get()})).then((function(e){return t._convertDocToQuestion(e,{gameId:n})}))}},{key:"update",value:function(e,t){var a=Object.assign({},t),n=P(a,"gameId");return this.firestore.collection("games").doc(n).collection("questions").doc(e).update(a)}},{key:"list",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=this.firestore,n={};return"gameId"in t&&(a=a.collection("games").doc(t.gameId).collection("questions"),n.gameId=t.gameId),"from"in t&&(a=a.where("order",">",t.from)),a=a.orderBy("order"),"limit"in t&&(a=a.limit(t.limit)),a.get().then((function(t){return t.docs.map((function(t){return e._convertDocToQuestion(t,n)}))}))}},{key:"_convertDocToQuestion",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign({id:e.id},e.data(),t)}}]),a}(O),z=function(e){var t=new G;return(new _).get(e.gameId).then((function(e){return t.get(e.currentQuestionId,{gameId:e.id})})).then((function(t){return e.isCorrect=t.correctAnswer===e.choice,e.questionId=t.id,console.log(e),(new U).create(e)}))},R=function(e){var t=e.recordAnswer;return r.a.createElement(T.a,null,["A","B","C","D"].map((function(e){return r.a.createElement(q.a,{sm:12,md:6,className:"mb-4",key:e},r.a.createElement(f.a,{className:"w-100 h-100",onClick:function(){return t(e)}},r.a.createElement("strong",null,e)))})))},F=function(){var e=Object(i.h)(),t=e.gameId,a=e.playerId,c=Object(n.useState)(),l=Object(u.a)(c,2),o=l[0],s=l[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),h=d[0],f=d[1],g=Object(n.useState)(null),v=Object(u.a)(g,2),E=v[0],b=v[1],p=Object(n.useState)(""),j=Object(u.a)(p,2),O=j[0],w=j[1],y=function(e){e&&(b(null),s(e))};Object(n.useEffect)((function(){t&&a&&(A(t,y),W(a,{gameId:t}).then((function(e){return f(e.name)})))}),[t,a]);switch(o?o.state:null){case"pendingQuestion":return r.a.createElement(S,{maxWidth:500,verticalCentered:!0},"Cargando proxima pregunta...");case"showingQuestion":return E?r.a.createElement(S,{maxWidth:500,verticalCentered:!0},"Elegiste ",E.choice,"!"):r.a.createElement(S,{maxWidth:500,verticalCentered:!0},r.a.createElement(T.a,{className:"mb-4"},r.a.createElement(q.a,{sm:12},r.a.createElement("h2",null,"Hola ",h,"!"),r.a.createElement("h3",null,"Elige tu respuesta"))),r.a.createElement(R,{recordAnswer:function(e){z({playerId:a,playerName:h,gameId:t,choice:e}).then(b).catch((function(e){w(e),setTimeout((function(){return w("")}),5e3)}))}}),O?r.a.createElement(Q.a,{color:"danger"},O):null);case"showingQuestionResults":return r.a.createElement(S,{maxWidth:500,verticalCentered:!0},r.a.createElement("div",null,"Mostrando resultados de la pregunta"));default:return r.a.createElement(S,{maxWidth:500,verticalCentered:!0},"Esperando a que empieze el juego")}},L=a(92),B=a(93),M=a(41),V=a.n(M),J=function(e){return(new _).list({shortCode:String(e),state:N.STATE_WAITING_FOR_PLAYERS})},Y=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),g=Object(u.a)(l,2),v=g[0],E=g[1];return a.length>1?r.a.createElement(S,{maxWidth:500,verticalCentered:!0},r.a.createElement(L.a,null,a.map((function(e){return r.a.createElement(o.b,{key:e.id,to:"/join/".concat(e.id)},r.a.createElement(B.a,{tag:"button",action:!0},e.name))})))):1==a.length?r.a.createElement(i.a,{to:"/join/".concat(a[0].id)}):r.a.createElement(S,{maxWidth:500,verticalCentered:!0},r.a.createElement("h1",{className:V.a.hero_heading},"Vialquiz!"),r.a.createElement(s.a,{className:"mb-5",onSubmit:function(e){e.preventDefault(),J(v).then(c)}},r.a.createElement(m.a,null,r.a.createElement(d.a,{for:"shortCode"},"Codigo de juego:"),r.a.createElement(h.a,{id:"shortCode",type:"number",value:v,onChange:function(e){return E(e.target.value)}})),r.a.createElement(f.a,{color:"primary",disabled:!v,type:"submit"},"Encontrar juego")))},H=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new w,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new _;return n.update(e,{state:"waitingForPlayers"}),a.list({gameId:e},t)},X=function(e){var t=e.players;return r.a.createElement(L.a,null,t.map((function(e){return r.a.createElement(B.a,{key:e.id},e.name)})))},K=function(e){var t=Object(i.h)().gameId,a=Object(n.useState)([]),c=Object(u.a)(a,2),l=c[0],s=c[1],m=Object(n.useState)(null),d=Object(u.a)(m,2),h=d[0],g=d[1],v="".concat(window.location.origin,"/cahoots/");return Object(n.useEffect)((function(){t&&(H(t,s),A(t).then(g))}),[t]),r.a.createElement(S,{verticalCentered:!0,maxWidth:800},r.a.createElement("h1",{className:"mb-4"},"Esperando a que se unan jugadores"),r.a.createElement("p",null,"Para unirse entra a ",r.a.createElement("a",{href:v,rel:"noopener noreferrer",target:"_blank"},v)," y pone el codigo ",r.a.createElement("strong",null,h?h.shortCode:"___")),r.a.createElement(X,{players:l}),r.a.createElement("div",{className:"mt-4"},r.a.createElement(o.b,{to:"/host/".concat(t,"/questions/pending")},r.a.createElement(f.a,{color:"primary"},"Empezar"))))},$=function(e){Object(E.a)(a,e);var t=Object(b.a)(a);function a(){return Object(g.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"create",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.email,n=t.password;return this.auth.createUserWithEmailAndPassword(a,n).then((function(t){var a=t.user;return e._convertUser(a)})).catch((function(e){var t=e.code,a=e.message;"auth/weak-password"===t?alert("The password is too weak."):alert(a)}))}},{key:"login",value:function(e){var t=this,a=e.email,n=e.password;return this.auth.signInWithEmailAndPassword(a,n).then((function(e){var a=e.user;return t._convertUser(a)})).catch((function(e){var t=e.code,a=e.message;"auth/weak-password"===t?alert("The password is too weak."):alert(a)}))}},{key:"onCurrentUserChange",value:function(e){var t=this;this.auth.onAuthStateChanged((function(a){a&&e(t._convertUser(a))}))}},{key:"_convertUser",value:function(e){return{id:e.uid,email:e.email,name:e.displayName}}}]),a}(O),Z=function(e){var t=e.email,a=e.password;return(new $).create({email:t,password:a})},ee=function(e){var t=e.email,a=e.password;return(new $).login({email:t,password:a})},te=function(e,t){var a=t.email,n=t.password,r=t.authFn,c=t.successCallback;e.preventDefault(),r({email:a,password:n}).then((function(e){return c(e)}))},ae=function(e){var t=e.onUserChange,a=Object(n.useState)(""),c=Object(u.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(""),g=Object(u.a)(i,2),v=g[0],E=g[1];return r.a.createElement(s.a,{className:"mb-5",onSubmit:function(e){return te(e,{email:l,password:v,authFn:Z,successCallback:t})}},r.a.createElement(m.a,null,r.a.createElement(d.a,{for:"email"},"Email:"),r.a.createElement(h.a,{id:"email",name:"email",value:l,onChange:function(e){return o(e.target.value)}})),r.a.createElement(m.a,null,r.a.createElement(d.a,null,"Password:"),r.a.createElement(h.a,{type:"password",name:"password",value:v,onChange:function(e){return E(e.target.value)}})),r.a.createElement(f.a,{color:"primary"},"Sign Up"))},ne=function(e){var t=e.onUserChange,a=Object(n.useState)(""),c=Object(u.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(""),g=Object(u.a)(i,2),v=g[0],E=g[1];return r.a.createElement(s.a,{className:"mb-5",onSubmit:function(e){return te(e,{email:l,password:v,authFn:ee,successCallback:t})}},r.a.createElement(m.a,null,r.a.createElement(d.a,{for:"email"},"Email:"),r.a.createElement(h.a,{id:"email",name:"email",value:l,onChange:function(e){return o(e.target.value)}})),r.a.createElement(m.a,null,r.a.createElement(d.a,null,"Password:"),r.a.createElement(h.a,{type:"password",name:"password",value:v,onChange:function(e){return E(e.target.value)}})),r.a.createElement(f.a,{color:"primary"},"Login"))},re=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(null),s=Object(u.a)(o,2),m=s[0],d=s[1],h=function(e){e.preventDefault(),l(!c)};return m?r.a.createElement(i.a,{to:"/games"}):c?r.a.createElement(S,{maxWidth:500,verticalCentered:!0},r.a.createElement("h1",null,"Logeate"),r.a.createElement(ne,{onUserChange:d}),r.a.createElement("div",null,"No tienes cuenta? ",r.a.createElement("br",null),r.a.createElement(f.a,{color:"link",onClick:h},"Sign Up!"))):r.a.createElement(S,{maxWidth:500,verticalCentered:!0},r.a.createElement("h1",null,"Registrate"),r.a.createElement(ae,{onUserChange:d}),r.a.createElement("div",null,"Cuenta existente? ",r.a.createElement("br",null),r.a.createElement(f.a,{color:"link",onClick:h},"Login")))},ce=function(){var e=new $;return new Promise((function(t){return e.onCurrentUserChange(t)}))},le=function(){var e=new _;return ce().then((function(t){return t?e.list({ownerId:t.id}):null}))},oe=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(null),o=Object(u.a)(l,2),s=o[0],m=o[1];return Object(n.useEffect)((function(){le().then(c)}),[]),s?r.a.createElement(i.a,{to:s}):r.a.createElement(C.a,{style:{maxWidth:"500px"}},r.a.createElement("h1",null,"Your Games"),r.a.createElement(L.a,null,a.map((function(e){return r.a.createElement(B.a,{key:e.id,onClick:function(){return m("/games/".concat(e.id))},tag:"button",action:!0},e.name)})),r.a.createElement(B.a,{onClick:function(){return m("/games/create")},tag:"button",color:"info",action:!0},"Crear juego")))},ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _,a=String(Math.floor(Math.random()*Math.floor(9999)));return t.create(Object.assign({shortCode:a},e))},ue=function(e){var t=Object(n.useState)(null),a=Object(u.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(""),s=Object(u.a)(o,2),g=s[0],v=s[1],E=Object(n.useState)(null),b=Object(u.a)(E,2),p=b[0],j=b[1];return Object(n.useEffect)((function(){ce().then(l)}),[]),p?r.a.createElement(i.a,{to:"/games"}):r.a.createElement(C.a,{style:{maxWidth:"500px"}},r.a.createElement("h1",null,"Create a Game"),r.a.createElement(m.a,null,r.a.createElement(d.a,{for:"name"},"Name:"),r.a.createElement(h.a,{id:"name",name:"name",value:g,onChange:function(e){return v(e.target.value)}})),r.a.createElement(f.a,{color:"primary",onClick:function(){return e={name:g,ownerId:c.id},t=j,ie(e).then(t);var e,t}},"Save"))},se=function(e){var t=new _,a=new G;return t.update(e,{state:"pendingQuestion"}),t.get(e).then((function(e){return"currentQuestion"in e?a.get(e.currentQuestion):void 0})).then((function(t){var n=t?t.order:0;return a.list({gameId:e,from:n,limit:1})})).then((function(a){var n=a[0];return n&&t.update(e,{currentQuestionId:n.id}),n}))},me=function e(t){var a=t.endDate,n=t.intervalCallback,r=t.endedCallback;setTimeout((function(){var t=function(e){var t=(e-Date.now())/1e3;return t>0?t:0}(a);t>0?(n(t),e({endDate:a,intervalCallback:n,endedCallback:r})):r(t)}),1e3)},de=function(e){var t=e.seconds,a=e.intervalCallback,n=e.endedCallback,r=new Date(Date.now()+1e3*t);me({endDate:r,intervalCallback:a,endedCallback:n})},he=function(e){var t=e.parentUrl,a=Object(i.h)().gameId,c=Object(n.useState)(5),l=Object(u.a)(c,2),o=l[0],s=l[1],m=Object(n.useState)(null),d=Object(u.a)(m,2),h=d[0],f=d[1];return Object(n.useEffect)((function(){a&&(de({seconds:5,intervalCallback:s,endedCallback:s}),se(a).then(f))}),[a]),r.a.createElement(S,{verticalCentered:!0},r.a.createElement("div",{className:"mb-4"},"Proxima pregunta en..."),r.a.createElement("div",{className:"display-1"},Math.ceil(o)),o<=0&&h?r.a.createElement(i.a,{to:"".concat(t,"/questions/current")}):null)},fe=a(94),ge=a(95),ve=a(96),Ee=a(97),be=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new G;return a.get(e,t)},pe=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new U;return a.update(e,{state:"showingQuestionResults"}),n.list({gameId:e,questionId:t}).then((function(e){var t={A:[],B:[],C:[],D:[]};return e.forEach((function(e){t[e.choice]=t[e.choice].concat(e.playerName)})),t}))},je=function(e){return(new G).list({gameId:e}).then((function(e){return e.length}))},Oe=function(e,t){return e.correctAnswer===t},we=function(e){var t=e.result,a=e.className,n=e.question;return r.a.createElement("div",{className:a},r.a.createElement("h2",{className:"mb-4"},n?n.text:null),r.a.createElement(T.a,null,Object.entries(t).map((function(e){var t=Object(u.a)(e,2),a=t[0],c=t[1];return r.a.createElement(q.a,{sm:12,md:6,className:"mb-4"},r.a.createElement(fe.a,{color:Oe(n,a)?"success":null,inverse:!!Oe(n,a)||null},r.a.createElement(ge.a,null,r.a.createElement(ve.a,null,r.a.createElement("strong",{className:"mr-2"},a),Oe(n,a)?"\u2714\ufe0f":"\u274c"),r.a.createElement(Ee.a,null,c.join(", ")))))}))))},ye=function(e){var t=e.parentUrl,a=Object(i.h)(),c=a.gameId,l=a.questionId,s=Object(n.useState)({}),m=Object(u.a)(s,2),d=m[0],h=m[1],g=Object(n.useState)(null),v=Object(u.a)(g,2),E=v[0],b=v[1],p=Object(n.useState)(null),j=Object(u.a)(p,2),O=j[0],w=j[1];return Object(n.useEffect)((function(){c&&l&&(be(l,{gameId:c}).then(b),je(c).then(w),pe(c,l).then(h))}),[c,l]),r.a.createElement(S,{verticalCentered:!0},r.a.createElement(we,{className:"mb-4",result:d,question:E}),E&&E.order>=O?r.a.createElement(o.b,{to:"".concat(t,"/results/final")},r.a.createElement(f.a,{color:"primary"},"Show Final Results")):r.a.createElement(o.b,{to:"".concat(t,"/questions/pending")},r.a.createElement(f.a,{color:"primary"},"Next Question")))},Ce=a(98),Ie=function(e){return(new U).list({gameId:e}).then((function(e){return e.filter((function(e){return"isCorrect"in e&&!!e.isCorrect})).reduce((function(e,t){return t.playerName in e?e[t.playerName]+=1:e[t.playerName]=1,e}),{})}))},ke=function(e,t){var a=Object(u.a)(e,2)[1],n=Object(u.a)(t,2)[1];return a>n?-1:a<n?1:0},Se=function(e){var t=e.results,a=Object.entries(t);return a.sort(ke),r.a.createElement(L.a,null,a.slice(0,5).map((function(e,t){var a=Object(u.a)(e,2),n=a[0],c=a[1];return t<=2?r.a.createElement(B.a,{key:n,className:"d-flex justify-content-between"},n,r.a.createElement(Ce.a,{className:"ml-4 p-2",color:"success"},c)):r.a.createElement(B.a,{key:n,className:"d-flex justify-content-between"},n,r.a.createElement(Ce.a,{className:"ml-4 p-2"},c))})))},Ne=function(e){var t=Object(i.h)().gameId,a=Object(n.useState)({}),c=Object(u.a)(a,2),l=c[0],o=c[1];return Object(n.useEffect)((function(){t&&Ie(t).then(o)}),[t]),r.a.createElement(S,{verticalCentered:!0,maxWidth:500},r.a.createElement("h1",null,"Resultados Finales"),r.a.createElement(Se,{results:l}))},_e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new G;return t.update(e,{state:"showingQuestion"}),t.get(e).then((function(e){return a.get(e.currentQuestion)}))},Ae=function(e){var t=e.question,a=e.className;return r.a.createElement("div",{className:a},r.a.createElement("h2",{className:"mb-4"},t.text),r.a.createElement(T.a,null,["A","B","C","D"].map((function(e){return r.a.createElement(q.a,{key:e,sm:12,md:6,className:"mb-4"},r.a.createElement(fe.a,null,r.a.createElement(ge.a,null,r.a.createElement(ve.a,null,r.a.createElement("strong",null,e)),r.a.createElement(Ee.a,null,t["answer".concat(e)]))))}))))},De=function(e){var t=e.isVisible,a=e.linkTo;return t?r.a.createElement(o.b,{to:a},r.a.createElement(f.a,{color:"primary"},"Ver resultados")):null},xe=function(e){var t=e.parentUrl,a=Object(i.h)().gameId,c=Object(n.useState)(null),l=Object(u.a)(c,2),o=l[0],s=l[1],m=Object(n.useState)(10),d=Object(u.a)(m,2),h=d[0],f=d[1];return Object(n.useEffect)((function(){a&&(de({seconds:10,intervalCallback:f,endedCallback:f}),_e(a).then(s))}),[a]),r.a.createElement(S,{verticalCentered:!0},o?r.a.createElement("div",null,r.a.createElement(Ae,{question:o}),r.a.createElement("div",{className:"mt-4"},"Tiempo restante:"),r.a.createElement("div",{className:"display-1"},Math.ceil(h)),r.a.createElement(De,{isVisible:h<=0,linkTo:"".concat(t,"/results/").concat(o.id)})):r.a.createElement("div",null,"Loading..."))},Te=function(){var e=Object(i.i)(),t=e.url,a=e.path;return r.a.createElement(i.d,{base:!0},r.a.createElement(i.b,{path:"".concat(a,"/questions/pending")},r.a.createElement(he,{parentUrl:t})),r.a.createElement(i.b,{path:"".concat(a,"/questions/current")},r.a.createElement(xe,{parentUrl:t})),r.a.createElement(i.b,{path:"".concat(a,"/results/final")},r.a.createElement(Ne,{parentUrl:t})),r.a.createElement(i.b,{path:"".concat(a,"/results/:questionId")},r.a.createElement(ye,{parentUrl:t})))},qe=function(e){return(new G).list(e)},Qe=a(42),We=a(99),Ue=a(100),Pe=a(43),Ge=a(101),ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new G,a=Object.assign({},e);if("id"in a){var n=P(a,"id");return t.update(n,a)}return t.create(a)},Re=function(e){var t=e.question,a=Object(n.useState)(t),c=Object(u.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)("default"),s=Object(u.a)(i,2),g=s[0],v=s[1],E=function(e){o(Object.assign({},l,e))};return r.a.createElement("div",null,r.a.createElement(fe.a,{body:!0,className:"mt-4 mb-4"},r.a.createElement(ve.a,null,r.a.createElement(We.a,{className:"mb-2"},r.a.createElement(h.a,{type:"textarea",placeholder:"Question text",value:l.text||"",onChange:function(e){return E({text:e.target.value})}}))),["answerA","answerB","answerC","answerD"].map((function(e){return r.a.createElement(We.a,{key:e,className:"mb-2"},r.a.createElement(Ue.a,{addonType:"prepend"},r.a.createElement(Pe.a,null,e)),r.a.createElement(h.a,{placeholder:"Answer",value:e in l?l[e]:"",onChange:function(t){return E(Object(Qe.a)({},e,t.target.value))}}))})),r.a.createElement(m.a,null,r.a.createElement(d.a,{for:"correctAnswerDropdown"},"Correct Answer"),r.a.createElement(h.a,{type:"select",name:"correctAnswer",id:"correctAnswerDropdown","data-testid":"correctAnswerDropdown",value:l.correctAnswer||"A",onChange:function(e){return E({correctAnswer:e.target.value})}},r.a.createElement("option",null,"A"),r.a.createElement("option",null,"B"),r.a.createElement("option",null,"C"),r.a.createElement("option",null,"D"))),"saving"===g?r.a.createElement(f.a,{disabled:!0,color:"primary",className:"mt-4"},r.a.createElement(Ge.a,{type:"grow",size:"sm",color:"info",className:"mr-2"}),"Saving..."):r.a.createElement(f.a,{color:"primary",className:"mt-4",onClick:function(){v("saving"),ze(l).then((function(){return v("default")}))}},"Save")))},Fe=function(e){var t=Object(i.h)().gameId,a=Object(n.useState)(null),c=Object(u.a)(a,2),l=c[0],s=c[1],m=Object(n.useState)([]),d=Object(u.a)(m,2),h=d[0],g=d[1];return Object(n.useEffect)((function(){t&&null===l&&A(t).then((function(e){return s(e),e})).then((function(e){return qe({gameId:e.id})})).then(g)}),[t,l]),l?r.a.createElement(S,{maxWidth:500},r.a.createElement("h1",{className:"mb-4"},l.name),h.length>0?r.a.createElement(o.b,{to:"/lobby/".concat(t)},r.a.createElement(f.a,{color:"success",size:"lg"},"Comenzar juego")):null,h.map((function(e){return r.a.createElement(Re,{key:e.id,question:e})})),r.a.createElement(f.a,{onClick:function(){ze({gameId:t,order:h.length+1}).then((function(e){return g(h.concat([e]))}))}},"Add Question")):r.a.createElement(S,{maxWidth:500},"Loading...")},Le=function(e){var t=new URLSearchParams(Object(i.g)().search).get("game");return r.a.createElement(S,{maxWidth:500,verticalCentered:!0},t)};var Be=function(){return r.a.createElement(o.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/login"},r.a.createElement(re,null)),r.a.createElement(i.b,{path:"/host/:gameId"},r.a.createElement(Te,null)),r.a.createElement(i.b,{path:"/lobby/:gameId"},r.a.createElement(K,null)),r.a.createElement(i.b,{path:"/play/:gameId/as/:playerId"},r.a.createElement(F,null)),r.a.createElement(i.b,{path:"/join/:gameId"},r.a.createElement(x,null)),r.a.createElement(i.b,{path:"/join"},r.a.createElement(Le,null)),r.a.createElement(i.b,{path:"/games/create"},r.a.createElement(ue,null)),r.a.createElement(i.b,{path:"/games/:gameId"},r.a.createElement(Fe,null)),r.a.createElement(i.b,{exact:!0,path:"/games"},r.a.createElement(oe,null)),r.a.createElement(i.b,{path:"/"},r.a.createElement(Y,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(Be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,1,2]]]);
//# sourceMappingURL=main.f8e9ea7f.chunk.js.map